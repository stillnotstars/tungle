<!DOCTYPE html>
<html>
<head>

<title>{Title}</title>

<link rel="shortcut icon" href="{Favicon}">
<link rel="alternate" type="application/rss+xml" href="{RSS}">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />

{block:Description}
    <meta name="description" content="{MetaDescription}" />
{/block:Description}

<meta name="if:Show Avatar" content="" />
<meta name="image:Background Image" content="">
<meta name="color:Background" content="#a084b4" />
<meta name="color:Text" content="#000" />
<meta name="color:Post Background" content="#fff" />
<meta name="color:Links" content="#4f156a" />
<meta name="color:Bubbles" content="#b094c4" />
<meta name="color:Bubble Text" content="#000">
<meta name="color:Bubble Links" content="#4f156a">
<meta name="if:Show Search" content="1">
<meta name="if:Show Archive" content="" />
<meta name="select:Font" content="Helvetica" />
<meta name="select:Font" content="Georgia" />
<meta name="select:Font" content="Verdana" />
<meta name="if:Show Filter" content="1" />
<meta name="text:Filter Terms" content="write the tags you use for tagging stuff separated by commas, punctuation unnecessary">

<style type="text/css">

body {
    font-family: {select:font};
    color: {color:text};
    background: {color:background} url("{image:background image}");
    margin: 0;
}

.post {
    width: max(40%, 550px);
    margin: 0 auto 150px;
    padding: 10px;
}

#notes {
    background-color: {color:post background};
    padding: 1px 10px 10px 10px;
    width: max(40%, 550px);
    margin: 0 auto 150px;
}

.box {
    border: 5px solid {color:Bubbles};
    border-radius: 5px;
    background-color: {color:post background};
}

#search {
    font-size: 20px;
    padding: 5px;
    font-family: Verdana;
    width: calc(100% - 5px);
}

a {
    color: {color:links};
}

h1 {
    margin-top: 0;
}

blockquote {
    border-left: 1px solid black;
    margin-left: 5px;
    margin-right: 0;
    padding-left: 15px;
}

header {
    font-size: 22px;
    height: 100vh;
    background-color: {color:post background};
    border: 0;
    position: fixed;
    width: max(25%, 250px);
    border-right: 5px solid {color:Bubbles};
}

main {
    overflow: auto;
    padding-left: max(250px, 25%);
    padding-top: 100px;
    font-size: 20px;
}

#notbl {
    {block:ifshowfilter}
        height: calc(60vh - 40px);
        padding-bottom: 10px;
    {/block:ifshowfilter}
    padding: 30px;
    overflow-y: auto;
    overflow-x: hidden;
}

{block:ifshowfilter}
#filter {
    overflow-y: auto;
    background: {color:post background};
    font-size: 20px;
    padding: 30px;
    padding-bottom: 0;
    height: calc(40vh - 31.6px);
    border-top: 2px #aaa dashed;
}

#filter h2 {
    font-size: 24px;
    margin: 0;
}

#filterbutton {
    font-size: 20px;
    width: 150px;
    display: block;
    margin: auto;
    text-align: center;
    padding: 5px;
    margin: 0 auto 30px;
    border: 5px solid #eee;
    border-radius: 0;
    font-family: {select:font};
}
{/block:ifshowfilter}


@media only screen and (max-width: 900px) {
    #notbl {
        height: auto;
    }

    {block:ifshowfilter}
    #filter {
        height: auto;
    }
    {/block:ifshowfilter}

    header {
        height: auto;
        width: min(80%, 550px);
        border: 5px solid {color:Bubbles};
        border-radius: 5px;
        background-color: {color:post background};
        position: static;
        margin: auto;
        margin-top: 40px;
    }
    
    main {
        padding-left: 0;
    }

    .post, #notes {
        width: min(80%, 550px);
    }
}

#profileicon {
    display: grid;
    place-items: center;
    margin-bottom: 10px;
}

#profileicon img {
    border-radius: 50%;
    width: auto;
    height: auto;
}

#title {
    margin: 0;
    font-size: 1.3em;
    line-height: 120%;
    margin-bottom: 10px;
}

nav {
    margin-top: 10px;
    font-size: 22px;
}

nav a {
    text-decoration: none;
}

nav ul {
    list-style: none;
    padding: 0;
}

nav li:before {
    content: "â˜† "
}

label p {
    margin: 0;
}

.explainbl {
    display: none;
}

#pages {
    margin-bottom: 40px;
}

#pages a {
    display:inline-block;
    background-color: {color:post background};
    border: 4px solid {color:bubbles};
    padding: 4px 8px;
    border-radius: 3px;
    font-size: 0.9em;
}

.tags {
    padding-bottom: 10px;
}

.sr-only {
    position: absolute;
    clip: rect(1px, 1px, 1px, 1px);
    overflow: hidden;
}

.sr-only.firstnav {
    top: 50px;
    left: 40%;
}

.focusable:focus {
    clip: auto;
    width: auto;
    height: auto;
    overflow: auto;
    background-color: {color:Post Background};
    font-size: 1em;
    z-index: 10000000;
}

.question {
    padding: 5px;
    margin-bottom: 10px;
    border-radius: 5px;
    background-color: {color:bubbles};
    color: {color:bubble text};
}

.questions a {
    color: {color:bubble links};
}

.odd {
    background-color: {color:bubbles};
    color: {color:bubble text};
    border-radius: 5px;
}

.odd a {
    color: {color:bubble links};
}

#navdescription {
    font-size: 21px;
    border-bottom: 3px solid #888;
}

#notes ol {
    list-style: none;
}

.avatar:not(.post) {
    width: 24px;
    height: 24px;
    margin-right: 7px;
}

img:not(.lightbox-image) {
    width: 100%;
    height: 100%;
}

hr {
    border: 1px solid {color:links};
    width: 80%;
}
</style>
</head>
<body>
<div id="theme-wrapper">
<header>

<div id="notbl">
    {block:ifshowavatar}<div id="profileicon"><a href="/"><img src="{PortraitURL-96}" alt="click to go to index" /></a></div>{/block:ifshowavatar}
    
    {block:ifnotshowavatar}<a style="text-decoration: none;" href="/">{/block:ifnotshowavatar}<h1 id="title">{Title}</h1>{block:ifnotshowavatar}</a>{/block:ifnotshowavatar}
    
    <div style="font-size: 20px;">{Description}</div>
    
    <nav>
        <ul>
        {block:HasPages}{block:Pages}<li><a href="{URL}">{Label}</a></li>{/block:Pages}{/block:HasPages}
        {block:AskEnabled}<li><a href="/ask">{AskLabel}</a></li>{/block:AskEnabled}
        {block:SubmissionsEnabled}<li><a href="/submit">{SubmitLabel}</a></li>{/block:SubmissionsEnabled}
        {block:ifshowarchive}<li><a href="/archive">Archive</a></li>{/block:ifshowarchive}
        </ul>
    </nav>
    
    {block:ifshowsearch}
    <form action="/search" style="margin-top: 10px;" method="get">
        <input type="text" id="search" name="q" value="{SearchQuery}" placeholder="Search..."/>
    </form>
    {/block:ifshowsearch}
    
    <div style="font-size: 18px; margin-top: 15px; margin-bottom: 30px;">
        <a href="https://github.com/stillnotstars/tungle">Theme Credit</a>
    </div>

</div>

{block:ifshowfilter}
<div id="filter">
    <h2>Filter</h2>
    <a class="sr-only focusable" style="padding: 10px;" href="#main">skip filter</a>
    <div id="blterms">
    </div>
    <br>
    <button id="filterbutton" class="box">filter</button>
</div>
{/block:ifshowfilter}

</header>


<main id="main">

{block:SearchPage}
    {block:nosearchresults}
        <div class="post box">
            <h3>No Posts Found</h3>
        </div>
    {/block:nosearchresults}
{/block:SearchPage}

{block:Posts}
    <div class="post box {TagsAsClasses}">
        <div class="explainbl">
            <p>This post has been hidden because it was tagged: <span class="inserttag"></span>. <a href="{Permalink}">Click here to view it</a>.</p>
            {block:HasTags}<p>Click here to <a class="showtags" href="#">see the tags</a>.</p>
            <p>tagged: {block:Tags}<a href="{TagURL}">#{Tag}</a> {/block:Tags}</p>{/block:HasTags}
        </div>

        {block:Text}<div class="postbody">
            <h2 class="sr-only">Text post: </h2>
            {block:Title}<h2><a href="{Permalink}">{Title}</a></h2>{/block:Title}
            <div>{block:Reblogs}<a class="tumblr_blog" href="{Permalink}">{Username}</a>{Body}<div style="height: 10px"></div>
            {/block:Reblogs}
            {block:NotReblog}{Body}{/block:NotReblog}
        {/block:Text}
        
        {block:Photo}<div class="postbody">
            <h2 class="sr-only">Photo post: </h2>
            {LinkOpenTag}<img src="{PhotoUrl-400}" alt>{LinkCloseTag}
            <div class="postcontent">{block:Caption}{Caption}{/block:Caption}
        {/block:Photo}
        
        {block:Photoset}<div class="postbody">
            <h2 class="sr-only">Photoset: </h2>
            {Photoset}
            <div class="postcontent">{block:Caption}{Caption}{/block:Caption}
        {/block:Photoset}
        
        {block:Quote}<div class="postbody">
            <h2 class="sr-only">Quote: </h2>
            <h2>"{Quote}"</h2>
            {block:Source}<div class="postcontent">{Source}{/block:Source}
        {/block:Quote}
        
        {block:Link}<div class="postbody">
            <h2 class="sr-only">Link post: </h2>
            <h2><a href="{URL}" {Target}>{Name}</a></h2>
            <div>
            {block:Description}<div class="postcontent">{Description}</div>{/block:Description}
        {/block:Link}
        
        {block:Chat}<div class="postbody">
            <h2 class="sr-only">Chat post: </h2>
            {block:Title}<h2><a href="{Permalink}">{Title}</a></h2>{/block:Title}
            <div class="postcontent">
                {block:Lines}
                    <div class="{Alt}">{block:Label}<b>{Label}</b>{/block:Label} {Line}</div>
                {/block:Lines}
        
        {/block:Chat}
        
        {block:Video}<div class="postbody">
            <h2 class="sr-only">Video post: </h2>
            {Video-400}
            <div class="postcontent">{block:Caption}{Caption}{/block:Caption}
        {/block:Video}
        
        {block:Audio}<div class="postbody">
            <h2 class="sr-only">Audio post: </h2>
            <div style="height: 85px; overflow: hidden;">{AudioEmbed}</div>
            {block:Caption}<div class="postcontent">{Caption}{/block:Caption}
        {/block:Audio}
        
        {block:Answer}<div class="postbody">
            <h2 class="sr-only">Ask post:</h2>
            <div class="question"><em>{Asker} asked:</em><br>{Question}</div>
            <div class="postcontent">
            {block:Answerer}
                <div>{Answerer}: </div>
                <div>{Answer}</div>
            {/block:Answerer}
        
                {Replies}
        {/block:Answer}
        
        </div>

        <div class="postinfo">
            {block:HasTags}<div class="tags">Tagged: {block:Tags}<a href="{TagURL}">#{Tag}</a> {/block:Tags}</div>{/block:HasTags}

            <div style="display: grid; grid-template-columns: 1fr 60px;">
                <div>
                    <div>{block:PinnedPostLabel}<i>{PinnedPostLabel}.</i> {/block:PinnedPostLabel}{block:Date}{TimeAgo}{/block:Date} {block:NoteCount}/ {NoteCountWithLabel}{/block:NoteCount} / <a href="{Permalink}">Permalink</a></div>
                    {block:RebloggedFrom}<div>reblogged from: <a href="{ReblogParentURL}">{ReblogParentName}</a> / source: <a href="{ReblogRootURL}">{ReblogRootName}</a></div>{/block:RebloggedFrom}
                </div>
                <div style="display: flex;">
                    <div style="flex: 0 1; margin: 5px;">
                        <span class="sr-only">like button: </span>{LikeButton}
                    </div>
                    <div style="flex: 0 1; margin: 5px;">
                        <span class="sr-only">reblog button: </span>{ReblogButton}
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

{/block:Posts}

{block:PostNotes}
    <div id="notes" class="box">
        {PostNotes}
    </div>
{/block:PostNotes}

{block:IndexPage}
<center id="pages">
    {block:Pagination}{block:PreviousPage}<a href="{PreviousPage}">previous page</a>{/block:PreviousPage}<span style="width: 100px; display: inline-block"></span>
    {block:NextPage}<a href="{NextPage}">next page</a>{/block:NextPage}
    {/block:Pagination}
</center>
{/block:IndexPage}

</main>
</div>

<script type="text/javascript">
{block:ifshowfilter}
function declass(tag){
    return tag.replace(/\_/g, ' ').replace(/\./g, '');
}

function reclass(tag){
    return tag.replace(/ /g, '_');
}

function forAllClass(classname, fn) {
    let elements = document.getElementsByClassName(classname);
    for (let i = 0; i < elements.length; i++) {
        fn(elements[i]);
    }
}

let blocktags = "{text:filter terms}".split(',').map((str) => str.trim());
let blterms = document.getElementById("blterms");
for (let [i, tag] of blocktags.entries()) {
    blterms.innerHTML += '<label><p><input type="checkbox" id="bl' + i + '"> <span id="labelbl' + i + '">' + tag + '</span></p></label>';
}
let blockclasses = blocktags.map(reclass)

document.getElementById("filterbutton").onclick = () => {
    forAllClass('postbody', (p) => {p.style.display = ""});
    forAllClass('postinfo', (p) => {p.style.display = ""});
    forAllClass('inserttag', (p) => {p.innerHTML = ""});
    forAllClass('tags', (p) => {p.style.display = ""});
    forAllClass('explainbl', (p) => {p.style.display = "none"});

    for (let i = 0; i < blocktags.length; i++) {
        if (document.getElementById("bl" + i).checked) {
            let texttoblock = blockclasses[i];
            forAllClass(texttoblock, (post) => {
                post.querySelector(".inserttag").innerHTML +=  " #" + declass(texttoblock);
                post.querySelector(".postbody").style.display = "none";
                post.querySelector(".tags").style.display = "none";
                post.querySelector(".explainbl").style.display = "block";
            })
        }
    }
}

forAllClass("showtags", (showtags) => {
    showtags.onclick = (e) => {
        e.preventDefault();
        let tagsDisplay = showtags.parentElement.nextElementSibling;
        if (tagsDisplay.style.display == "none") {
            tagsDisplay.style.display = "block"
        } else {
            tagsDisplay.style.display = "none"
        }
    }
});
{/block:ifshowfilter}

let imgs = document.getElementsByTagName("img");
for (let i = 0; i < imgs.length; i++) {
    var alt = imgs[i].alt;
    if (alt != "") {
        imgs[i].title = alt;
    }
}
</script>
</body>
